<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
   
<h1>
    <nav class="navbar bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" font-size = 400px>Hiesenberg</a>
          <div>
            <a href = "/users/sign-in">Sign In</a> 
            <a href = "/users/sign-up">Sign UP</a>
          </div>
          <form class="d-flex" role="search">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
          </form>
        </div>
      </nav>
    Welcome to my Home page
</h1>

<section id = "feed-posts">
<h4>
  Posts
</h4>
<!-- the form for getting the post data -->
<!-- since we want to show this post form only when user is signed in -->
<% if(locals.user) {%>
<form action="/posts/create" id="new-post-form" method="post"> 
    <textarea name="content" cols="30" rows="3"  placeholder="Create your Post..."></textarea>
    <input type="submit" value="post">
</form>
<%}
%>
<!-- showing all the posts -->
<div id="posts-list-container">
  <ul>
    <% for (post of posts){ %>
      <li>
        <% if (locals.user && locals.user.id == post.user.id) {%>
        <small>
          <a href="/posts/destroy/<%= post._id%>">X</a>
        </small>
        <%}%>
        <p>
          <%= post.content %>
        <br>
        <small>
          
        </small>
        </p>
        <div class="post-comments">
          <% if(locals.user){%>
            <form action="/comments/create" id="new-post-form" method="post">
              <input type="text" name="content"  placeholder="Type comment..."></input>
              <!-- this line is for sending the post id to the server -->
              <input type="hidden" name="post" value="<%= post._id%>"></input>
              <input  type="submit" value="Add commnent">
            </form>
            <%}%>
            <div class="post-comments-list">
                <ul id="post-comments-<%=posts._id%>">
                      <% for(comment in posts.comments) {%>
                        <p>
                          <% if (locals.user && locals.user.id == comment.user.id) {%>
                            <small>
                              <a href="/comments/destroy/<%= comment._id%>">X</a>
                            </small>
                            <%}%> 
                          <%= comment.content%>
                          <br>
                          <small>
                            <%=comment.user.name %>
                          </small>
                        </p>
                        <%}%>
                </ul>
            </div>
        </div>
      </li>
      <%}%>
      
  </ul>
</div>

</section>