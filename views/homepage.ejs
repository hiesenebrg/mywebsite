<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
   
<link rel="stylesheet" href="/css/home.css">
<link rel="stylesheet" href="/css/chat_box.css">
<h1>
    <nav class="navbar bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" font-size = 400px>Hiesenberg</a>
          <div>
            
            <% if(locals.user){%>
              <li> <%= user.name%></li>
              <span><img src="<%= user.avatar%>" alt="<%= user.name%>" width="100"></span>
              <li><a href = "/users/sign-out">Sign Out</a></li>
              <%} else {%>
                <li><a href = "/users/sign-in">Sign In</a></li> 
                <li><a href = "/users/sign-up">Sign UP</a></li>
              <%}%>
          </div>
          <form class="d-flex" role="search">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
          </form>
        </div>
      </nav>
    Welcome to my Home page
</h1>

<section id = "feed-posts">
<h4>
  Posts
</h4>
<!-- the form for getting the post data -->
<!-- since we want to show this post form only when user is signed in -->
<% if(locals.user) {%>
<form action="/posts/create" id="new-post-form" method="post"> 
    <textarea name="content" cols="30" rows="3"  placeholder="Create your Post..."></textarea>
    <input type="submit" value="post">
</form>
<%}
%>
<!-- showing all the posts -->
<div id="posts-list-container">
  <ul>
    <% for (post of posts){ %> 

      <%- include('_post') -%> 

      <%}%>
      
  </ul>
</div>

</section>

<section id="user-friends">
<h4>USER</h4>
<% for(u of all_users){%>
  <p>
    <a href="/users/profilepage/<%= u._id%>"> <%= u.name%> </a>
  </p>

  <%}%>
</section>

<section>
  <%- include('_chat_box') -%> 
</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.2/socket.io.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.2/socket.io.js" integrity="sha512-Y8KodDCDqst1e8z0EGKiqEQq3T8NszmgW2HvsC6+tlNw7kxYxHTLl5Iw/gqZj/6qhZdBt+jYyOsybgSAiB9OOA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
<script src="js/chat_engine.js"></script>
<%if(locals.user){%>
  <script>
    new ChatEngine("user-chat-box",'<%= locals.user.email%>')
  </script>
  <% } %>